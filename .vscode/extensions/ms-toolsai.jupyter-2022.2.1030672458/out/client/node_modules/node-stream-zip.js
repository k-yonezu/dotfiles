/*! For license information please see node-stream-zip.js.LICENSE.txt */
(()=>{var t={51020:(t,e,i)=>{var r=i(73837),n=i(57147),s=i(71017),o=i(82361),a=i(59796),h=i(12781),f=101010256,c=117853008,u=101075792,l=4294967295,d=65535,p=function(t){var e,i,r,o,h,p=this,L=!1!==t.storeEntries?{}:null,w=t.file;function k(t,e){if(t||!e)return p.emit("error",t||"Archive read error");for(var i=o.win.buffer,r=o.lastPos,n=r-o.win.position,s=o.minPos;--r>=s&&--n>=0;)if(i.length-n>=4&&i[n]===o.firstByte&&i.readUInt32LE(n)===o.sig)return o.lastBufferPosition=n,o.lastBytesRead=e,void o.complete();if(r===s)return p.emit("error","Bad archive");if(o.lastPos=r+1,o.chunkSize*=2,r<=s)return p.emit("error","Bad archive");var a=Math.min(o.chunkSize,r-s);o.win.expandLeft(a,k)}function S(){var t=o.win.buffer,e=o.lastBufferPosition;try{(h=new m).read(t.slice(e,e+22)),h.headerOffset=o.win.position+e,h.commentLength?p.comment=t.slice(e+22,e+22+h.commentLength).toString():p.comment=null,p.entriesCount=h.volumeEntries,p.centralDirectory=h,h.volumeEntries===d&&h.totalEntries===d||h.size===l||h.offset===l?(20,o.lastBufferPosition>20?(o.lastBufferPosition-=20,x()):(o={win:o.win,totalReadLength:20,minPos:o.win.position-20,lastPos:o.win.position,chunkSize:o.chunkSize,firstByte:80,sig:c,complete:x}).win.read(o.lastPos-o.chunkSize,o.chunkSize,k)):(o={},P())}catch(t){p.emit("error",t)}}function x(){var t=o.win.buffer,e=new E;e.read(t.slice(o.lastBufferPosition,o.lastBufferPosition+20));var r=i-e.headerOffset;(o={win:o.win,totalReadLength:r,minPos:e.headerOffset,lastPos:o.lastPos,chunkSize:o.chunkSize,firstByte:80,sig:u,complete:B}).win.read(i-o.chunkSize,o.chunkSize,k)}function B(){var t=o.win.buffer,e=new v;e.read(t.slice(o.lastBufferPosition,o.lastBufferPosition+56)),p.centralDirectory.volumeEntries=e.volumeEntries,p.centralDirectory.totalEntries=e.totalEntries,p.centralDirectory.size=e.size,p.centralDirectory.offset=e.offset,p.entriesCount=e.volumeEntries,o={},P()}function P(){(o={win:new g(e),pos:h.offset,chunkSize:r,entriesLeft:h.volumeEntries}).win.read(o.pos,Math.min(r,i-o.pos),R)}function R(e,i){if(e||!i)return p.emit("error",e||"Entries read error");var n=o.win.buffer,s=o.pos-o.win.position,a=n.length,h=o.entry;try{for(;o.entriesLeft>0;){h||((h=new y).readHeader(n,s),h.headerOffset=o.win.position+s,o.entry=h,o.pos+=46,s+=46);var f=h.fnameLen+h.extraLen+h.comLen;if(a-s<f+(o.entriesLeft>1?46:0))return o.win.moveRight(r,R,s),void(o.move=!0);h.read(n,s),t.skipEntryNameValidation||h.validateName(),L&&(L[h.name]=h),p.emit("entry",h),o.entry=h=null,o.entriesLeft--,o.pos+=f,s+=f}p.emit("ready")}catch(e){p.emit("error",e)}}function j(){if(!L)throw new Error("storeEntries disabled")}function O(t){return t.offset+30+t.fnameLen+t.extraLen}function D(t){return 8!=(8&t.flags)}function M(t,i,r){p.stream(t,(function(s,o){var a,h;s?r(s):(o.on("error",(function(t){h=t,a&&(o.unpipe(a),a.close((function(){r(t)})))})),n.open(i,"w",(function(s,f){if(s)return r(s||h);h?n.close(e,(function(){r(h)})):((a=n.createWriteStream(i,{fd:f})).on("finish",(function(){p.emit("extract",t,i),h||r()})),o.pipe(a))})))}))}function C(t,e,i){if(!e.length)return i();var r=e.shift();r=s.join(t,s.join.apply(s,r)),n.mkdir(r,(function(r){if(r&&"EEXIST"!==r.code)return i(r);C(t,e,i)}))}function T(t,e,i,r,n){if(!i.length)return r(null,n);var o=i.shift(),a=s.join(t,o.name.replace(e,""));M(o,a,(function(s){if(s)return r(s,n);T(t,e,i,r,n+1)}))}n.open(w,"r",(function(s,a){if(s)return p.emit("error",s);e=a,n.fstat(e,(function(n,s){if(n)return p.emit("error",n);var a;i=s.size,r=t.chunkSize||Math.round(i/1e3),r=Math.max(Math.min(r,Math.min(131072,i)),Math.min(1024,i)),a=Math.min(65557,i),(o={win:new g(e),totalReadLength:a,minPos:i-a,lastPos:i,chunkSize:Math.min(1024,r),firstByte:80,sig:f,complete:S}).win.read(i-o.chunkSize,o.chunkSize,k)}))})),Object.defineProperty(this,"ready",{get:function(){return!1}}),this.entry=function(t){return j(),L[t]},this.entries=function(){return j(),L},this.stream=function(t,i){return this.openEntry(t,(function(t,r){if(t)return i(t);var n=O(r),s=new b(e,n,r.compressedSize);if(0===r.method);else{if(8!==r.method&&9!==r.method)return i("Unknown compression method: "+r.method);s=s.pipe(a.createInflateRaw())}D(r)&&(s=s.pipe(new U(s,r.crc,r.size))),i(null,s)}),!1)},this.entryDataSync=function(t){var i=null;if(this.openEntry(t,(function(e,r){i=e,t=r}),!0),i)throw i;var r=Buffer.alloc(t.compressedSize);if(new I(e,r,0,t.compressedSize,O(t),(function(t,e){i=t})).read(!0),i)throw i;if(0===t.method);else{if(8!==t.method&&9!==t.method)throw new Error("Unknown compression method: "+t.method);r=a.inflateRawSync(r)}if(r.length!==t.size)throw new Error("Invalid size");return D(t)&&new z(t.crc,t.size).data(r),r},this.openEntry=function(t,i,r){if("string"==typeof t&&(j(),!(t=L[t])))return i("Entry not found");if(!t.isFile)return i("Entry is not file");if(!e)return i("Archive closed");var n=Buffer.alloc(30);new I(e,n,0,n.length,t.offset,(function(e){if(e)return i(e);var r;try{t.readDataHeader(n),t.encrypted&&(r="Entry encrypted")}catch(t){r=t}i(r,t)})).read(r)},this.extract=function(t,e,i){var r=t||"";if("string"==typeof t&&((t=this.entry(t))?r=t.name:r.length&&"/"!==r[r.length-1]&&(r+="/")),!t||t.isDirectory){var o=[],a=[],h={};for(var f in L)if(Object.prototype.hasOwnProperty.call(L,f)&&0===f.lastIndexOf(r,0)){var c=f.replace(r,""),u=L[f];if(u.isFile&&(o.push(u),c=s.dirname(c)),c&&!h[c]&&"."!==c){h[c]=!0;var l=c.split("/").filter((function(t){return t}));for(l.length&&a.push(l);l.length>1;){var d=(l=l.slice(0,l.length-1)).join("/");if(h[d]||"."===d)break;h[d]=!0,a.push(l)}}}a.sort((function(t,e){return t.length-e.length})),a.length?C(e,a,(function(t){t?i(t):T(e,r,o,i,0)})):T(e,r,o,i,0)}else n.stat(e,(function(r,n){n&&n.isDirectory()?M(t,s.join(e,s.basename(t.name)),i):M(t,e,i)}))},this.close=function(t){e?n.close(e,(function(i){e=null,t&&t(i)})):t&&t()}};p.setFs=function(t){n=t},r.inherits(p,o.EventEmitter);var m=function(){};m.prototype.read=function(t){if(22!=t.length||t.readUInt32LE(0)!=f)throw new Error("Invalid central directory");this.volumeEntries=t.readUInt16LE(8),this.totalEntries=t.readUInt16LE(10),this.size=t.readUInt32LE(12),this.offset=t.readUInt32LE(16),this.commentLength=t.readUInt16LE(20)};var E=function(){};E.prototype.read=function(t){if(20!=t.length||t.readUInt32LE(0)!=c)throw new Error("Invalid zip64 central directory locator");this.headerOffset=k.readUInt64LE(t,8)};var v=function(){};v.prototype.read=function(t){if(56!=t.length||t.readUInt32LE(0)!=u)throw new Error("Invalid central directory");this.volumeEntries=k.readUInt64LE(t,24),this.totalEntries=k.readUInt64LE(t,32),this.size=k.readUInt64LE(t,40),this.offset=k.readUInt64LE(t,48)};var y=function(){};function L(t,e){for(var i=(t>>>0).toString(2);i.length<e;)i="0"+i;return i.split("")}function w(t,e){var i=L(t,16),r=L(e,16),n={h:parseInt(i.slice(0,5).join(""),2),m:parseInt(i.slice(5,11).join(""),2),s:2*parseInt(i.slice(11,16).join(""),2),Y:parseInt(r.slice(0,7).join(""),2)+1980,M:parseInt(r.slice(7,11).join(""),2),D:parseInt(r.slice(11,16).join(""),2)},s=[n.Y,n.M,n.D].join("-")+" "+[n.h,n.m,n.s].join(":")+" GMT+0";return new Date(s).getTime()}y.prototype.readHeader=function(t,e){if(t.length<e+46||33639248!=t.readUInt32LE(e))throw new Error("Invalid entry header");this.verMade=t.readUInt16LE(e+4),this.version=t.readUInt16LE(e+6),this.flags=t.readUInt16LE(e+8),this.method=t.readUInt16LE(e+10);var i=t.readUInt16LE(e+12),r=t.readUInt16LE(e+12+2);this.time=w(i,r),this.crc=t.readUInt32LE(e+16),this.compressedSize=t.readUInt32LE(e+20),this.size=t.readUInt32LE(e+24),this.fnameLen=t.readUInt16LE(e+28),this.extraLen=t.readUInt16LE(e+30),this.comLen=t.readUInt16LE(e+32),this.diskStart=t.readUInt16LE(e+34),this.inattr=t.readUInt16LE(e+36),this.attr=t.readUInt32LE(e+38),this.offset=t.readUInt32LE(e+42)},y.prototype.readDataHeader=function(t){if(67324752!=t.readUInt32LE(0))throw new Error("Invalid local header");this.version=t.readUInt16LE(4),this.flags=t.readUInt16LE(6),this.method=t.readUInt16LE(8);var e=t.readUInt16LE(10),i=t.readUInt16LE(12);this.time=w(e,i),this.crc=t.readUInt32LE(14)||this.crc;var r=t.readUInt32LE(18);r&&r!==l&&(this.compressedSize=r);var n=t.readUInt32LE(22);n&&n!==l&&(this.size=n),this.fnameLen=t.readUInt16LE(26),this.extraLen=t.readUInt16LE(28)},y.prototype.read=function(t,e){this.name=t.slice(e,e+=this.fnameLen).toString();var i=t[e-1];this.isDirectory=47==i||92==i,this.extraLen&&(this.readExtra(t,e),e+=this.extraLen),this.comment=this.comLen?t.slice(e,e+this.comLen).toString():null},y.prototype.validateName=function(){if(/\\|^\w+:|^\/|(^|\/)\.\.(\/|$)/.test(this.name))throw new Error("Malicious entry: "+this.name)},y.prototype.readExtra=function(t,e){for(var i,r,n=e+this.extraLen;e<n;)i=t.readUInt16LE(e),e+=2,r=t.readUInt16LE(e),e+=2,1===i&&this.parseZip64Extra(t,e,r),e+=r},y.prototype.parseZip64Extra=function(t,e,i){i>=8&&this.size===l&&(this.size=k.readUInt64LE(t,e),e+=8,i-=8),i>=8&&this.compressedSize===l&&(this.compressedSize=k.readUInt64LE(t,e),e+=8,i-=8),i>=8&&this.offset===l&&(this.offset=k.readUInt64LE(t,e),e+=8,i-=8),i>=4&&this.diskStart===d&&(this.diskStart=t.readUInt32LE(e))},Object.defineProperty(y.prototype,"encrypted",{get:function(){return 1==(1&this.flags)}}),Object.defineProperty(y.prototype,"isFile",{get:function(){return!this.isDirectory}});var I=function(t,e,i,r,n,s){this.fd=t,this.buffer=e,this.offset=i,this.length=r,this.position=n,this.callback=s,this.bytesRead=0,this.waiting=!1};I.prototype.read=function(t){var e;if(p.debug&&console.log("read",this.position,this.bytesRead,this.length,this.offset),this.waiting=!0,t){try{var i=n.readSync(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead)}catch(t){e=t}this.readCallback(t,e,e?i:null)}else n.read(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead,this.readCallback.bind(this,t))},I.prototype.readCallback=function(t,e,i){if("number"==typeof i&&(this.bytesRead+=i),e||!i||this.bytesRead===this.length)return this.waiting=!1,this.callback(e,this.bytesRead);this.read(t)};var g=function(t){this.position=0,this.buffer=Buffer.alloc(0);var e=null;this.checkOp=function(){if(e&&e.waiting)throw new Error("Operation in progress")},this.read=function(i,r,n){this.checkOp(),this.buffer.length<r&&(this.buffer=Buffer.alloc(r)),this.position=i,e=new I(t,this.buffer,0,r,this.position,n).read()},this.expandLeft=function(i,r){this.checkOp(),this.buffer=Buffer.concat([Buffer.alloc(i),this.buffer]),this.position-=i,this.position<0&&(this.position=0),e=new I(t,this.buffer,0,i,this.position,r).read()},this.expandRight=function(i,r){this.checkOp();var n=this.buffer.length;this.buffer=Buffer.concat([this.buffer,Buffer.alloc(i)]),e=new I(t,this.buffer,n,i,this.position+n,r).read()},this.moveRight=function(i,r,n){this.checkOp(),n?this.buffer.copy(this.buffer,0,n):n=0,this.position+=n,e=new I(t,this.buffer,this.buffer.length-n,n,this.position+this.buffer.length-n,r).read()}},b=function(t,e,i){h.Readable.prototype.constructor.call(this),this.fd=t,this.offset=e,this.length=i,this.pos=0,this.readCallback=this.readCallback.bind(this)};r.inherits(b,h.Readable),b.prototype._read=function(t){var e=Buffer.alloc(Math.min(t,this.length-this.pos));e.length?n.read(this.fd,e,0,e.length,this.offset+this.pos,this.readCallback):this.push(null)},b.prototype.readCallback=function(t,e,i){this.pos+=e,t?(this.emit("error",t),this.push(null)):e?(e!==i.length&&(i=i.slice(0,e)),this.push(i)):this.push(null)};var U=function(t,e,i){h.Transform.prototype.constructor.call(this),this.verify=new z(e,i);var r=this;t.on("error",(function(t){r.emit("error",t)}))};r.inherits(U,h.Transform),U.prototype._transform=function(t,e,i){var r;try{this.verify.data(t)}catch(t){r=t}i(r,t)};var z=function(t,e){this.crc=t,this.size=e,this.state={crc:-1,size:0}};z.prototype.data=function(t){for(var e=z.getCrcTable(),i=this.state.crc,r=0,n=t.length;--n>=0;)i=e[255&(i^t[r++])]^i>>>8;if(this.state.crc=i,this.state.size+=t.length,this.state.size>=this.size){var s=Buffer.alloc(4);if(s.writeInt32LE(4294967295&~this.state.crc,0),(i=s.readUInt32LE(0))!==this.crc)throw new Error("Invalid CRC");if(this.state.size!==this.size)throw new Error("Invalid size")}},z.getCrcTable=function(){var t=z.crcTable;if(!t){z.crcTable=t=[];for(var e=Buffer.alloc(4),i=0;i<256;i++){for(var r=i,n=8;--n>=0;)0!=(1&r)?r=3988292384^r>>>1:r>>>=1;r<0&&(e.writeInt32LE(r,0),r=e.readUInt32LE(0)),t[i]=r}}return t};var k={readUInt64LE:function(t,e){return 4294967296*t.readUInt32LE(e+4)+t.readUInt32LE(e)}};t.exports=p},82361:t=>{"use strict";t.exports=require("events")},57147:t=>{"use strict";t.exports=require("fs")},71017:t=>{"use strict";t.exports=require("path")},12781:t=>{"use strict";t.exports=require("stream")},73837:t=>{"use strict";t.exports=require("util")},59796:t=>{"use strict";t.exports=require("zlib")}},e={},i=function i(r){var n=e[r];if(void 0!==n)return n.exports;var s=e[r]={exports:{}};return t[r](s,s.exports,i),s.exports}(51020);module.exports=i})();
//# sourceMappingURL=node-stream-zip.js.map